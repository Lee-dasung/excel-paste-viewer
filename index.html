<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>엑셀 붙여넣기 디버깅</title>
  <style>
    #pasteArea {
      border: 2px dashed #007bff;
      padding: 20px;
      min-height: 200px;
      background: #fff;
    }
  </style>
</head>
<body>
  <h2>엑셀 붙여넣기 테스트</h2>
  <p>엑셀에서 복사한 표를 아래에 붙여넣고 콘솔(F12)을 확인하세요.</p>
  <div id="pasteArea" contenteditable="true">여기에 붙여넣기 (Ctrl+V)</div>

  <script>
    const pasteArea = document.getElementById('pasteArea');

    pasteArea.addEventListener('paste', function (e) {
      e.preventDefault();
      const clipboard = e.clipboardData;

      console.log("📋 클립보드 디버깅 시작 ===");

      if (!clipboard) {
        console.warn("❌ clipboardData 없음");
        return;
      }

      if (!clipboard.items || clipboard.items.length === 0) {
        console.warn("❌ clipboard.items 없음 또는 비어 있음");
      } else {
        for (let i = 0; i < clipboard.items.length; i++) {
          const item = clipboard.items[i];
          console.log(`📄 Item[${i}]: kind=${item.kind}, type=${item.type}`);
        }
      }

      const html = clipboard.getData('text/html');
      const text = clipboard.getData('text/plain');

      console.log("📄 text/plain:", text || "(없음)");
      console.log("📄 text/html:", html || "(없음)");

      if (html) pasteArea.innerHTML += html;
      else if (text) pasteArea.innerText += text;
      else pasteArea.innerText += "[클립보드에 텍스트 없음]";
    });
  </script>
</body>
</html>
